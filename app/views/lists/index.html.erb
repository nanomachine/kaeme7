<% provide(:title, 'Lists') %>

<%= render 'layouts/sidebar' %>
<%= will_paginate %>

<!-- Main content box heading, shape, size, etc -->

<div class="row-fluid fluid-box">		
	<div class="box span12">
		<div class="box-header">
			<h2><i class="icon-list"></i><span class="break"></span></h2>
			<div class="box-icon">
				<%= link_to '#', class: 'btn btn-success btn-setting' do %>
				<i class="icon-plus"></i> New List
				<% end %>
			</div>
		</div>

<!-- Tabbed view of the current user's created lists and if current user is admin 
	the other tab will list all created lists -->
	<div class="box-content">
		<ul class="nav tab-menu nav-tabs tabs-lists" id="myTab">
			<li class="active"><a href="#mine">My Lists</a></li>
			<li><a href="#all">All Lists</a></li>
		</ul>
		<!-- Create partial for list indexing to eleminite repeated code -->
		<div id="myTabContent" class="tab-content">
			<div class="tab-pane active" id="mine">
				<table class="table table-striped table-bordered bootstrap-datatable datatable">
					<thead>
						<tr>
							<th>List #</th>
							<th>Name</th>
							<th>Description</th>
							<th>Owner</th>
							<th>Date Created</th>
							<th>Actions</th>
						</tr>
					</thead>   
					<tbody>
						<% current_user.lists.each do |list| %>
						<% @owner = User.find(list.user_id) %>
						<tr>
							<td><%= list.id %></td>
							<td><%= list.name %></td>
							<td><%= list.description %></td>
							<td><%= @owner.name %>
								<%= @owner.last_name %>
							</td>
							<td><%= list.created_at.strftime(" %b.%d %Y") %></td>
							<!--Action buttons for last column of list index table, Delete and More Info -->
							<td>
								<%= link_to list, class: 'btn btn-info' do %>
								<i class="icon-zoom-in icon-white"></i> 
								<% end %>
								<% if current_user.admin? || current_user.id==@owner.id %>
								<%= link_to list, method: :delete, data: { confirm: "Delete this list?" }, class: 'btn btn-danger' do %>
								<i class="icon-trash icon-white"></i> 
								<% end %>
								<% end %>
							</td>
						</tr>
						<% end %>
					</tbody>
				</table>
			</div>
			<!-- Content for all lists tab -->
			<div class="tab-pane" id="all">
				<table class="table table-striped table-bordered bootstrap-datatable datatable">
					<thead>
						<tr>
							<th>List #</th>
							<th>Name</th>
							<th>Description</th>
							<th>Owner</th>
							<th>Date Created</th>
							<th>Actions</th>

						</tr>
					</thead>   
					<tbody>
						<% @lists.each do |list| %>
						<% @owner = User.find(list.user_id) %>
						<tr>
							<td><%= list.id %></td>
							<td><%= list.name %></td>
							<td><%= list.description %></td>
							<td><%= @owner.name %>
								<%= @owner.last_name %>
							</td>
							<td><%= list.created_at.strftime(" %b.%d %Y") %></td>
							<!--Action buttons for list index table, Delete and More Info -->
							<td class="center">
								<%= link_to list, class: 'btn btn-info' do %>
								<i class="icon-zoom-in icon-white"></i> 
								<% end %>
								<% if current_user.admin? || current_user.id==list.user_id %>
								<%= link_to list, method: :delete, data: { confirm: "Delete this list?" }, class: 'btn btn-danger' do %>
								<i class="icon-trash icon-white"></i> 
								<% end %>
								<% end %>
							</td>
						</tr>
						<% end %>
					</tbody>
				</table>
			</div>
		</div>            
	</div>
</div><!--/span-->
</div><!--/row-->
<%= will_paginate %>

<%= form_for :list, :html => {:class => "form-horizontal"} do |f| %>

<div class="modal hide fade" id="myModal">
	<div class="modal-header">
		<button type="button" class="close" data-dismiss="modal"></button>
		<h3>New List Details</h3>
	</div>

	<div class="modal-body">
		<div class="control-group">
			<label class="control-label" for="focusedInput">List Name</label>
			<div class="controls">
				<div class="input-xlarge focused" id="focusedInput" type="text">
					<%= f.text_field :name, :placeholder => "Give the list a new name..." %>
				</div>
			</div>
		</div>


		<div class="control-group">
			<label class="control-label" for="focusedInput">Description</label>
			<div class="controls">
				<div class="input-xlarge focused" id="focusedInput" type="text">
					<%= f.text_field :description, :placeholder => "Update list description..." %>
				</div>
			</div>
		</div>
	</div>
	<div class="modal-footer"> 
		<a class="form-action btn" data-dismiss="modal">Close</a>
		<a class="form-action"> <%= f.submit "Create", class: "btn btn-success" %> </a>
	</div>
</div>
<% end %>